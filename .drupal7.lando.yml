######
# Drupal 7 1.3
# @see https://docs.devwithlando.io/tutorials/drupal7.html
# @see https://github.com/lando/lando/blob/master/examples/drupal7/.lando.yml
# @see https://docs.devwithlando.io/tutorials/setup-additional-services.html
######


# Name
name: APPNAME


# Recipe used
recipe: drupal7
config:
  webroot: .
  php: '7.0'
  via: apache
  drush: global:8.1.15
  database: mariadb:latest
  xdebug: false


# Commands on events
events:
  post-db-import:
    - appserver: cd $LANDO_WEBROOT && drush fra -y
    - appserver: cd $LANDO_WEBROOT && drush cc all -y
  post-start:
    - appserver: cd ~ && echo "alias ll='ls -la'" > .bashrc


# Access
proxy:
  appserver:
    - APPNAME.lndo.site
  mailhog:
    - mail.APPNAME.lndo.site
  pma:
    - pma.APPNAME.lndo.site


# Additional services
services:
  appserver:
    composer:
      deployer/deployer: '4.3.0'
  node:
    type: node:6.10
    globals:
      gulp-cli: "latest"
  mailhog:
    type: mailhog
    hogfrom:
      - appserver
  pma:
    type: phpmyadmin


# Additionnal commands line "lando XXX"
tooling:
  npm:
    service: node
  node:
    service: node
  yarn:
    service: node
  gulp:
    service: node
  dep:
    service: appserver
    description: "Deploy app with deploy.php"